<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.edushare_qa.Mapper.QuestionMapper">

    <select id="findByItem" resultType="org.example.edushare_qa.Pojo.Question">
        select * from questions
        <where>
            <if test="authorId!=null and authorId!=''">
                author_id=#{authorId}
            </if>
            <if test="title!=null and title!=''">
                and title like concat('%',#{title},'%')
            </if>
            <if test="content!=null and content!=''">
                and content like concat('%',#{content},'%')
            </if>
            <if test="classBelong!=null and classBelong!=''">
                and class_belong like concat('%',#{classBelong},'%')
            </if>
        </where>
    </select>

    <update id="update">
        update questions
        <set>
            <if test="authorId != null">author_id=#{authorId},</if>
            <if test="title != null">title=#{title},</if>
            <if test="content != null">content=#{content},</if>
            <if test="questionType != null">question_type=#{questionType},</if>
            <if test="classBelong != null">class_belong=#{classBelong},</if>
            <if test="tags != null">tags=#{tags},</if>
            <if test="fileUrl != null">file_url=#{fileUrl},</if>
            <if test="createdAt != null">created_at=#{createdAt},</if>
        </set>
        where id=#{id}
    </update>

    <select id="findQuestionByQuestionResearchParam" resultType="org.example.edushare_qa.Pojo.Question">
        select q.* from questions q
        left join classes c on q.class_belong = c.title
        <where>
            <if test="teacherName!=null and teacherName!=''">
                c.teacher_name = #{teacherName}
            </if>
            <if test="classBelong!=null and classBelong!=''">
                and q.class_belong like concat('%',#{classBelong},'%')
            </if>
            <if test="title!=null and title!=''">
                and q.title like concat('%',#{title},'%')
            </if>
        </where>
    </select>

</mapper>
